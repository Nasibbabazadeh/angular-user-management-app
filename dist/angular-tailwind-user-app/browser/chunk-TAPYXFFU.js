import{a as T,b as S,c as L,d as j,e as $,f as N,g as O,h as H,i as G,k as A}from"./chunk-WPGOZROZ.js";import{a as q,b as z}from"./chunk-N5H4NQVU.js";import{h as R}from"./chunk-EQAD5IQK.js";import{Ba as V,C as I,G as a,H as f,Ja as B,Q as v,S as l,Y as s,Z as r,_ as P,ba as y,da as p,ea as c,ha as n,ia as g,ja as b,l as k,ma as _,o as M,r as h,va as F,wa as D,x as m,y as u,ya as C,za as U}from"./chunk-ELYF35B5.js";var J=(()=>{class i{constructor(t){this._fb=t,this.mode="add",this.postData=null,this.formSubmit=new I,this.closeModal=new I}ngOnInit(){this.postForm=this._fb.group({title:[this.postData?this.postData.title:"",S.required],description:[this.postData?this.postData.description:"",S.required],tag:[this.postData?this.postData.tag:"",[S.required]]})}onSubmit(){this.postForm.valid&&this.formSubmit.emit(this.postForm.value)}onClose(){this.closeModal.emit()}static{this.\u0275fac=function(e){return new(e||i)(f(G))}}static{this.\u0275cmp=h({type:i,selectors:[["app-post-modal"]],inputs:{mode:"mode",postData:"postData"},outputs:{formSubmit:"formSubmit",closeModal:"closeModal"},standalone:!0,features:[_],decls:13,vars:3,consts:[[1,"absolute","inset-0","z-10","bg-black","bg-opacity-50","flex","items-center","justify-center"],[1,"bg-white","rounded-lg","p-6","max-w-lg","w-full"],[1,"text-lg","font-medium","mb-4"],[3,"ngSubmit","formGroup"],["type","text","formControlName","title","placeholder","Enter post title...",1,"mb-4","p-2","border","border-gray-300","rounded-md","w-full"],["type","text","formControlName","description","placeholder","Enter post description..",1,"mb-4","p-2","border","border-gray-300","rounded-md","w-full"],["type","text","formControlName","tag","placeholder","Enter post tag...",1,"mb-4","p-2","border","border-gray-300","rounded-md","w-full"],[1,"flex","justify-end","space-x-2"],["type","button",1,"px-4","py-2","bg-gray-500","text-white","rounded-lg",3,"click"],["type","submit",1,"px-4","py-2","bg-blue-600","text-white","rounded-lg",3,"disabled"]],template:function(e,o){e&1&&(s(0,"div",0)(1,"div",1)(2,"h2",2),n(3),r(),s(4,"form",3),p("ngSubmit",function(){return o.onSubmit()}),P(5,"input",4)(6,"input",5)(7,"input",6),s(8,"div",7)(9,"button",8),p("click",function(){return o.onClose()}),n(10," Cancel "),r(),s(11,"button",9),n(12," Add details "),r()()()()()),e&2&&(a(3),g(o.mode==="add"?"Add New User":"Edit User"),a(),l("formGroup",o.postForm),a(7),l("disabled",o.postForm.invalid))},dependencies:[A,N,T,L,j,O,H,C],encapsulation:2})}}return i})();var K=(()=>{class i{constructor(t,e){this._genericHttp=t,this._http=e,this._endpoint="users"}getUserPosts(t,e,o){let d=`${this._genericHttp.baseUrl}/${this._endpoint}/${t}/posts`,w=new U().set("page",e.toString()).set("limit",o.toString());return this._http.get(d,{params:w})}addPost(t,e){return this._genericHttp.postMethod(`${this._endpoint}/${t}/posts`,e)}updatePost(t,e,o){return this._genericHttp.putMethod(`${this._endpoint}/${t}/posts/${e}`,o)}deletePostById(t,e){return this._genericHttp.deleteMethod(`${this._endpoint}/${t}/posts/${e}`)}static{this.\u0275fac=function(e){return new(e||i)(M(z),M(V))}}static{this.\u0275prov=k({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();function X(i,x){if(i&1){let t=y();s(0,"div",11)(1,"div",12)(2,"h3",13),n(3),r(),s(4,"div",14)(5,"button",15),p("click",function(o){let d=m(t).$implicit;return c(2).openEditModal(d),u(o.stopPropagation())}),n(6," Edit Post "),r(),s(7,"button",16),p("click",function(o){let d=m(t).$implicit;return c(2).deletePostById(d.id),u(o.stopPropagation())}),n(8," Delete Post "),r()()(),s(9,"p",17),n(10),r(),s(11,"div",18)(12,"span"),n(13),r(),s(14,"span"),n(15),r(),s(16,"span"),n(17),r()(),s(18,"div",19)(19,"span",20),n(20),r()()()}if(i&2){let t=x.$implicit;a(3),b("Title : ",t.title,""),a(7),g(t.description),a(3),b("",t.likes," Likes"),a(2),b("",t.comments," Comments"),a(2),b("",t.views," Views"),a(3),g(t.tag)}}function Y(i,x){if(i&1){let t=y();s(0,"div"),v(1,X,21,6,"div",7),s(2,"div",8)(3,"button",9),p("click",function(){m(t);let o=c();return u(o.onPageChange(o.currentPage-1))}),n(4,"Previous"),r(),s(5,"button",10),p("click",function(){m(t);let o=c();return u(o.onPageChange(o.currentPage+1))}),n(6,"Next"),r()()()}if(i&2){let t=c();a(),l("ngForOf",t.posts),a(2),l("disabled",t.currentPage===1),a(2),l("disabled",t.posts.length<t.itemsPerPage)}}function Z(i,x){i&1&&(s(0,"div",21),n(1,"No posts found."),r())}function tt(i,x){if(i&1){let t=y();s(0,"app-post-modal",22),p("formSubmit",function(o){m(t);let d=c();return u(d.handleFormSubmit(o))})("closeModal",function(){m(t);let o=c();return u(o.closeModal())}),r()}if(i&2){let t=c();l("mode",t.modalMode)("postData",t.selectedPost)}}var Q=(()=>{class i{constructor(t,e,o,d){this._postService=t,this._err=e,this._toastr=o,this._activeRoute=d,this.addForm=new $({}),this.loading=!1,this.isModalOpen=!1,this.modalMode="add",this.selectedPost=null,this.posts=[],this.userId="",this.currentPage=1,this.itemsPerPage=2}ngOnInit(){this._activeRoute.params.subscribe(t=>{this.userId=t.id,this.loadUserPosts()})}loadUserPosts(){this._postService.getUserPosts(this.userId,this.currentPage,this.itemsPerPage).subscribe({next:t=>{this.posts=t},error:t=>{console.error("Error fetching posts:",t)}})}deletePostById(t){this._postService.deletePostById(this.userId,t).subscribe({next:e=>{e&&this._toastr.success("Post deleted successfully"),this.loadUserPosts()},error:e=>{this._err.handleError(e)}})}onPageChange(t){this.currentPage=t,this.loadUserPosts()}openUserModal(){this.modalMode="add",this.selectedPost=null,this.isModalOpen=!0}handleFormSubmit(t){this.modalMode==="add"?this._postService.addPost(this.userId,t).subscribe({next:()=>{this._toastr.success("Post added successfully!"),this.refreshPosts()},error:e=>{this._err.handleError(e)}}):this.modalMode==="edit"&&this.selectedPost&&this._postService.updatePost(this.userId,this.selectedPost.id,t).subscribe({next:()=>{this._toastr.success("Post updated successfully!"),this.refreshPosts()},error:e=>{this._err.handleError(e)}}),this.isModalOpen=!1}closeModal(){this.isModalOpen=!1}refreshPosts(){this._postService.getUserPosts(this.userId,this.currentPage,this.itemsPerPage).subscribe(t=>{this.posts=t})}openEditModal(t){this.modalMode="edit",this.selectedPost=t,this.isModalOpen=!0}static{this.\u0275fac=function(e){return new(e||i)(f(K),f(q),f(R),f(B))}}static{this.\u0275cmp=h({type:i,selectors:[["user-posts-list"]],standalone:!0,features:[_],decls:9,vars:3,consts:[[1,"flex","flex-col","items-end"],[1,"px-4","py-2","rounded-lg","bg-green-800","text-white","relative","top-5","right-10",3,"click"],[1,"container","mx-auto","px-4"],[1,"text-2xl","font-bold","mb-4"],[4,"ngIf"],["class","text-gray-600 text-center mt-4",4,"ngIf"],[3,"mode","postData","formSubmit","closeModal",4,"ngIf"],["class","bg-white shadow-md rounded-lg p-6 mb-4 flex flex-col gap-5",4,"ngFor","ngForOf"],[1,"flex","justify-center","my-4"],[1,"px-4","py-2","bg-blue-500","text-white","rounded-md","mr-2","disabled:bg-opacity-50","disabled:cursor-not-allowed",3,"click","disabled"],[1,"px-4","py-2","bg-blue-500","text-white","rounded-md","disabled:bg-opacity-40","disabled:cursor-not-allowed",3,"click","disabled"],[1,"bg-white","shadow-md","rounded-lg","p-6","mb-4","flex","flex-col","gap-5"],[1,"flex","justify-between"],[1,"text-xl","font-bold","mb-2"],[1,"flex","items-center","gap-2"],[1,"px-4","py-2","text-white","bg-blue-500","rounded-lg","hover:bg-blue-600","focus:outline-none","focus:ring-2","focus:ring-blue-300","dark:bg-blue-600","dark:hover:bg-blue-700","dark:focus:ring-blue-800",3,"click"],[1,"px-4","py-2","text-white","bg-red-500","rounded-lg","hover:bg-red-600","focus:outline-none","focus:ring-2","focus:ring-red-300","dark:bg-red-600","dark:hover:bg-red-700","dark:focus:ring-red-800",3,"click"],[1,"text-gray-600","mb-2"],[1,"flex","items-center","justify-between","text-sm","text-gray-500"],[1,"mt-4"],[1,"bg-blue-200","text-blue-800","px-2","py-1","rounded-md","text-sm"],[1,"text-gray-600","text-center","mt-4"],[3,"formSubmit","closeModal","mode","postData"]],template:function(e,o){e&1&&(s(0,"section",0)(1,"button",1),p("click",function(){return o.openUserModal()}),n(2,"Add new post"),r(),s(3,"div",2)(4,"h2",3),n(5,"User Posts"),r(),v(6,Y,7,3,"div",4)(7,Z,2,0,"div",5),r()(),v(8,tt,1,2,"app-post-modal",6)),e&2&&(a(6),l("ngIf",o.posts.length>0),a(),l("ngIf",o.posts.length===0),a(),l("ngIf",o.isModalOpen))},dependencies:[C,F,D,J],encapsulation:2})}}return i})();var Pt=(()=>{class i{static{this.\u0275fac=function(e){return new(e||i)}}static{this.\u0275cmp=h({type:i,selectors:[["app-user-posts"]],standalone:!0,features:[_],decls:1,vars:0,template:function(e,o){e&1&&P(0,"user-posts-list")},dependencies:[Q],encapsulation:2})}}return i})();export{Pt as UserPostsComponent};
